figma.showUI(__html__);

const theme = {
  "intents.ux.action.backgroundColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.action.borderColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.action.borderRadius": {
    "type": "static",
    "value": "5px"
  },
  "intents.ux.action.foregroundColor": {
    "type": "static",
    "value": "#111111"
  },
  "intents.ux.actionChosen.backgroundColor": {
    "type": "static",
    "value": "#61edea"
  },
  "intents.ux.actionChosen.borderColor": {
    "type": "static",
    "value": "#61edea"
  },
  "intents.ux.actionChosen.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionCritical.backgroundColor": {
    "type": "static",
    "value": "#ae1302"
  },
  "intents.ux.actionCritical.borderColor": {
    "type": "static",
    "value": "#ae1302"
  },
  "intents.ux.actionCritical.foregroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionCriticalChosen.backgroundColor": {
    "type": "static",
    "value": "#600801"
  },
  "intents.ux.actionCriticalChosen.borderColor": {
    "type": "static",
    "value": "#600801"
  },
  "intents.ux.actionCriticalChosen.foregroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionCriticalFocused.backgroundColor": {
    "type": "static",
    "value": "#ae1302"
  },
  "intents.ux.actionCriticalFocused.borderColor": {
    "type": "static",
    "value": "#ae1302"
  },
  "intents.ux.actionCriticalFocused.foregroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionCriticalFocused.outlineColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionCriticalHovered.backgroundColor": {
    "type": "static",
    "value": "#db1802"
  },
  "intents.ux.actionCriticalHovered.borderColor": {
    "type": "static",
    "value": "#db1802"
  },
  "intents.ux.actionCriticalHovered.foregroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionFocused.backgroundColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.actionFocused.borderColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.actionFocused.foregroundColor": {
    "type": "static",
    "value": "#09757a"
  },
  "intents.ux.actionFocused.outlineColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.actionHovered.backgroundColor": {
    "type": "static",
    "value": "#f5f7f8"
  },
  "intents.ux.actionHovered.borderColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.actionHovered.foregroundColor": {
    "type": "static",
    "value": "#00a4a6"
  },
  "intents.ux.actionControl.backgroundColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControl.borderColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControl.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionControlChosen.backgroundColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControlChosen.borderColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControlChosen.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionControlFocused.backgroundColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControlFocused.borderColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControlFocused.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionControlFocused.outlineColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionControlHovered.backgroundColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControlHovered.borderColor": {
    "type": "static",
    "value": "#f4f8fc"
  },
  "intents.ux.actionControlHovered.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionPrimary.backgroundColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimary.borderColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimary.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionPrimaryChosen.backgroundColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimaryChosen.borderColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimaryChosen.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionPrimaryFocused.backgroundColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimaryFocused.borderColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimaryFocused.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionPrimaryFocused.outlineColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionPrimaryHovered.backgroundColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimaryHovered.borderColor": {
    "type": "static",
    "value": "#fed317"
  },
  "intents.ux.actionPrimaryHovered.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionSecondary.backgroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionSecondary.borderColor": {
    "type": "static",
    "value": "#bac0c3"
  },
  "intents.ux.actionSecondary.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionSecondaryChosen.backgroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionSecondaryChosen.borderColor": {
    "type": "static",
    "value": "#bac0c3"
  },
  "intents.ux.actionSecondaryChosen.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionSecondaryFocused.backgroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionSecondaryFocused.borderColor": {
    "type": "static",
    "value": "#bac0c3"
  },
  "intents.ux.actionSecondaryFocused.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionSecondaryFocused.outlineColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.actionSecondaryHovered.backgroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.actionSecondaryHovered.borderColor": {
    "type": "static",
    "value": "#bac0c3"
  },
  "intents.ux.actionSecondaryHovered.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.box.backgroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.box.borderColor": {
    "type": "static",
    "value": "#EBEBEB"
  },
  "intents.ux.box.borderRadius": {
    "type": "static",
    "value": "8px"
  },
  "intents.ux.box.foregroundColor": {
    "type": "static",
    "value": "#444"
  },
  "intents.ux.boxHighContrast.backgroundColor": {
    "type": "static",
    "value": "#444"
  },
  "intents.ux.boxHighContrast.borderColor": {
    "type": "static",
    "value": "#444"
  },
  "intents.ux.boxHighContrast.foregroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.boxHighContrastOverlay.backgroundColor": {
    "type": "static",
    "value": "rgba(0,0,0,0.85)"
  },
  "intents.ux.boxHighContrastOverlay.foregroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.boxHighContrastOverlay.borderColor": {
    "type": "static",
    "value": "#444"
  },
  "intents.ux.boxLowContrast.backgroundColor": {
    "type": "static",
    "value": "#F5F7F8"
  },
  "intents.ux.boxLowContrast.borderColor": {
    "type": "static",
    "value": "#D4DBE0"
  },
  "intents.ux.boxLowContrast.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.boxLowContrastOverlay.backgroundColor": {
    "type": "static",
    "value": "rgba(255,255,255,0.2)"
  },
  "intents.ux.boxLowContrastOverlay.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.boxLowContrastOverlay.borderColor": {
    "type": "static",
    "value": "#d4dbe0"
  },
  "intents.ux.control.backgroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.control.borderColor": {
    "type": "static",
    "value": "#AAB7C2"
  },
  "intents.ux.control.borderRadius": {
    "type": "static",
    "value": "5px"
  },
  "intents.ux.control.foregroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.control.outlineColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.controlFocused.outlineColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.controlKnob.backgroundColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.controlKnob.borderColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.controlVoid.backgroundColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.controlVoid.borderColor": {
    "type": "static",
    "value": "transparent"
  },
  "intents.ux.controlVoid.foregroundColor": {
    "type": "static",
    "value": "#AAB7C2"
  },
  "intents.ux.feedback.feedbackColor": {
    "type": "static",
    "value": "#61EDEA"
  },
  "intents.ux.feedback.onFeedbackColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.feedbackCritical.feedbackColor": {
    "type": "static",
    "value": "#ae1302"
  },
  "intents.ux.feedbackCritical.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighContrastCritical.feedbackColor": {
    "type": "static",
    "value": "#ae1302"
  },
  "intents.ux.feedbackHighContrastCritical.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighContrastHighlight.feedbackColor": {
    "type": "static",
    "value": "#09757a"
  },
  "intents.ux.feedbackHighContrastHighlight.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighContrastInfo.feedbackColor": {
    "type": "static",
    "value": "#613ea3"
  },
  "intents.ux.feedbackHighContrastInfo.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighContrastInternal.feedbackColor": {
    "type": "static",
    "value": "#b4006c"
  },
  "intents.ux.feedbackHighContrastInternal.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighContrastNeutral.feedbackColor": {
    "type": "static",
    "value": "#145fa9"
  },
  "intents.ux.feedbackHighContrastNeutral.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighContrastSuccess.feedbackColor": {
    "type": "static",
    "value": "#003a15"
  },
  "intents.ux.feedbackHighContrastSuccess.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighContrastWarning.feedbackColor": {
    "type": "static",
    "value": "#aa6d00"
  },
  "intents.ux.feedbackHighContrastWarning.onFeedbackColor": {
    "type": "static",
    "value": "#fff"
  },
  "intents.ux.feedbackHighlight.feedbackColor": {
    "type": "static",
    "value": "#a6fff8"
  },
  "intents.ux.feedbackHighlight.onFeedbackColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.feedbackInfo.feedbackColor": {
    "type": "static",
    "value": "#FEDC45"
  },
  "intents.ux.feedbackInfo.onFeedbackColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.feedbackInternal.feedbackColor": {
    "type": "static",
    "value": "#fbd9ed"
  },
  "intents.ux.feedbackInternal.onFeedbackColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.feedbackNeutral.feedbackColor": {
    "type": "static",
    "value": "#ddeaf8"
  },
  "intents.ux.feedbackNeutral.onFeedbackColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.feedbackSuccess.feedbackColor": {
    "type": "static",
    "value": "#9fffb8"
  },
  "intents.ux.feedbackSuccess.onFeedbackColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.feedbackWarning.feedbackColor": {
    "type": "static",
    "value": "#ffeea9"
  },
  "intents.ux.feedbackWarning.onFeedbackColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.ux.figure.figureColor0": {
    "type": "static",
    "value": "#00a4a6"
  },
  "intents.ux.figure.figureColor1": {
    "type": "static",
    "value": "#ef6c0f"
  },
  "intents.ux.figure.figureColor2": {
    "type": "static",
    "value": "#744bc4"
  },
  "intents.ux.figure.figureColor3": {
    "type": "static",
    "value": "#aa6d00"
  },
  "intents.ux.figure.figureColor4": {
    "type": "static",
    "value": "#1976d2"
  },
  "intents.ux.figure.figureColor5": {
    "type": "static",
    "value": "#db1802"
  },
  "intents.ux.figure.figureColor6": {
    "type": "static",
    "value": "#00a4a6"
  },
  "intents.ux.figure.figureColor7": {
    "type": "static",
    "value": "#ef6c0f"
  },
  "intents.ux.figure.figureColor8": {
    "type": "static",
    "value": "#744bc4"
  },
  "intents.ux.figure.figureColor9": {
    "type": "static",
    "value": "#aa6d00"
  },
  "intents.ux.figure.figureColor10": {
    "type": "static",
    "value": "#1976d2"
  },
  "intents.ux.figure.figureColor11": {
    "type": "static",
    "value": "#db1802"
  },
  "intents.ux.text.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.text.fontSize": {
    "type": "static",
    "value": "1rem"
  },
  "intents.ux.text.fontWeight": {
    "type": "static",
    "value": "500"
  },
  "intents.ux.text.lineHeight": {
    "type": "static",
    "value": "1.5"
  },
  "intents.ux.textAction.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.textAction.fontSize": {
    "type": "static",
    "value": "1rem"
  },
  "intents.ux.textAction.fontWeight": {
    "type": "static",
    "value": "700"
  },
  "intents.ux.textAction.lineHeight": {
    "type": "static",
    "value": "1.5"
  },
  "intents.ux.textCaption.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.textCaption.fontSize": {
    "type": "static",
    "value": ".875rem"
  },
  "intents.ux.textCaption.fontWeight": {
    "type": "static",
    "value": "500"
  },
  "intents.ux.textCaption.lineHeight": {
    "type": "static",
    "value": "1.5"
  },
  "intents.ux.textHeading.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.textHeading.fontSize": {
    "type": "static",
    "value": "2rem"
  },
  "intents.ux.textHeading.fontWeight": {
    "type": "static",
    "value": "300"
  },
  "intents.ux.textHeading.lineHeight": {
    "type": "static",
    "value": "1.25"
  },
  "intents.ux.textInput.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.textInput.fontSize": {
    "type": "static",
    "value": "1rem"
  },
  "intents.ux.textInput.fontWeight": {
    "type": "static",
    "value": "500"
  },
  "intents.ux.textInput.lineHeight": {
    "type": "static",
    "value": "1.5"
  },
  "intents.ux.textLabel.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.textLabel.fontSize": {
    "type": "static",
    "value": "1rem"
  },
  "intents.ux.textLabel.fontWeight": {
    "type": "static",
    "value": "700"
  },
  "intents.ux.textLabel.lineHeight": {
    "type": "static",
    "value": "1.5"
  },
  "intents.ux.textParagraph.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.textParagraph.fontSize": {
    "type": "static",
    "value": "1rem"
  },
  "intents.ux.textParagraph.fontWeight": {
    "type": "static",
    "value": "500"
  },
  "intents.ux.textParagraph.lineHeight": {
    "type": "static",
    "value": "1.5"
  },
  "intents.ux.textTitle.fontFamily": {
    "type": "fontgroup",
    "value": [
      "\"gdsherpa\"",
      "Helvetica",
      "Arial",
      "sans-serif"
    ]
  },
  "intents.ux.textTitle.fontSize": {
    "type": "static",
    "value": "1.375rem"
  },
  "intents.ux.textTitle.fontWeight": {
    "type": "static",
    "value": "600"
  },
  "intents.ux.textTitle.lineHeight": {
    "type": "static",
    "value": "1.25"
  },
  "intents.uxToggleChosen.body.backgroundColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.uxToggleChosen.body.borderColor": {
    "type": "static",
    "value": "#111"
  },
  "intents.uxToggleChosen.knob.backgroundColor": {
    "type": "static",
    "value": "#fff"
  }
};

function normalizeName(name) {
  name = name.substring(0, 1).toUpperCase() + name.substring(1);

  return name.replace(/([A-Z]|[0-9]+)/g, ' $1').trim();
}

function getIntentName(intent) {
  if (intent.indexOf('intents.ux.') === 0) {
    intent = intent.substring(11);
  }

  const parts = intent.split('.');

  if (parts.length !== 2) {
    return null;
  }

  return normalizeName(parts[0]) + '/' + normalizeName(parts[1]);
}

function getPropertyName(intent) {
  if (intent.indexOf('intents.ux.') === 0) {
    intent = intent.substring(11);
  }

  const parts = intent.split('.');

  if (parts.length !== 2) {
    return null;
  }

  return parts[1];
}

function getIntentColorArray(intent) {
  if (intent.type !== 'static' || !intent.value) {
    return null;
  }

  if (intent.value === 'transparent') {
    return [];
  }

  if (intent.value.substring(0, 1) !== '#') {
    return null;
  }

  let color = intent.value.substring(1);

  if (color.length === 3) {
    color = color + color;
  }

  color = color.toUpperCase();

  const r = parseInt(color.substring(0, 2), 16) / 255;
  const g = parseInt(color.substring(2, 4), 16) / 255;
  const b = parseInt(color.substring(4, 6), 16) / 255;

  return [
    <SolidPaint>({
      type: 'SOLID',
      color: <RGB>({
        r: r,
        g: g,
        b: b
      })
    })
  ];
}

function createStyle(name, paints) {
  const myStyle = figma.createPaintStyle();
  myStyle.name = name;
  myStyle.paints = paints;
}

const fontProperties = {};
function ensureFontProperty(name) {
  name = name.split('/')[0];

  if (!fontProperties[name]) {
    fontProperties[name] = figma.createTextStyle();
    fontProperties[name].name = name;
  }

  return fontProperties[name];
}

function getFontSize(intent) {
  if (intent.type !== 'static' || !intent.value) {
    return null;
  }

  let val = intent.value;

  if (val.indexOf('rem') !== -1) {
    val = val.replace('rem', '');
    val = parseFloat(val) * 16;

    return val;
  }

  return parseInt(val);
}

function getFontType(weight) {
  const weights = {
    300: 'Light',
    400: 'Regular',
    500: 'Medium',
    600: 'Semibold',
    700: 'Bold'
  };

  return weights[weight] ? weights[weight] : 'Regular';
}

figma.loadFontAsync({ family: "Roboto", style: "Regular" });
figma.loadFontAsync({ family: 'GD Sherpa', style: 'Light' });
figma.loadFontAsync({ family: 'GD Sherpa', style: 'Regular' });
figma.loadFontAsync({ family: 'GD Sherpa', style: 'Medium' });
figma.loadFontAsync({ family: 'GD Sherpa', style: 'Semibold' });
figma.loadFontAsync({ family: 'GD Sherpa', style: 'Bold' });

figma.ui.onmessage = msg => {
  if (msg.type === 'create-styles') {
    for (const intent in theme) {
      const name = getIntentName(intent);
      const property = getPropertyName(intent);

      if (name === null) {
        continue;
      }

      if (property === 'fontFamily') {
        const font = ensureFontProperty(name);
        const fontName = theme[intent].value[0].replace(/"/g, '');

        font.fontName = <FontName>({
          family: fontName === 'gdsherpa' ? 'GD Sherpa' : fontName,
          style: font.fontName.style
        });
      } else if (property === 'fontWeight') {
        const font = ensureFontProperty(name);
        const type = getFontType(theme[intent].value);

        font.fontName = <FontName>({
          family: font.fontName.family,
          style: type
        });
      } else if (property === 'fontSize') {
        const font = ensureFontProperty(name);
        font.fontSize = getFontSize(theme[intent]);
      } else {
        const color = getIntentColorArray(theme[intent]);

        if (color === null) {
          console.log('Unknown property: ' + property);
          continue;
        }

        createStyle(name, color);
      }
    }
  }

  if (msg.type === 'delete-all-styles') {
    const paintStyles = figma.getLocalPaintStyles();

    for (const style of paintStyles) {
      style.remove();
    }

    const textStyles = figma.getLocalTextStyles();

    for (const style of textStyles) {
      style.remove();
    }
  }

  figma.closePlugin();
};
